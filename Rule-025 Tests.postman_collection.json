{
	"info": {
		"_postman_id": "51ac7b91-536a-48a3-a6c7-a9979bd89af7",
		"name": "Rule-025 Tests",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "AM-746 Scenario 1",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"",
							"const transactions = [\"96ae98292ec04bf29b5d40ba99864c38\"]",
							"const graphTransactions = [",
							"    \"d923682a97089a8416151ad1e58355b8eeee177007\",",
							"    \"d923682a97089a8416151ad1e58355b8eeee108008\",",
							"    \"d923682a97089a8416151ad1e58355b8eeee108007f7accd\"",
							"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"No aggregated transaction mirroring detected - amount too low, Result for Rule 025 is false\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(false);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"            \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});",
							"",
							"pm.test(\"Remove Seed Data from transactionGraph\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/pseudonyms/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(graphTransactions)}",
							"                        REMOVE { _key: transaction } IN transactionRelationship",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"const now = new Date().getTime();\r",
							"\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"96ae988992ec04bf29b5d40ba99864777\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"8d3b3600efb74f4196ac0e5e60365957\",\r",
							"                \"EndToEndId\": \"8d3b3600efb74f4196ac0e5e60365957\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 31020.89,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 8999,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"352afab0eed3e035ff73cec422c7d4a9f66f277cee9c16dc6bca02eba4d91566\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"24058ebbdd500fe2307cdd55186e0abcd9726de434ae492dbe9d1e12822914aa4\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"const transactionGraph = [{\r",
							"    _key: \"d923682a97089a8416151ad1e58355b8eeee177007\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f277cee9c16dc6bca02eba4d91566\",\r",
							"    _to: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de434ae492dbe9d1e12822914aa4\",\r",
							"    Amt: 8999,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"8d3b3600efb74f4196ac0e5e60365957\",\r",
							"    EndToEndId: \"8d3b3600efb74f4196ac0e5e60365957\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a84161514d1e58355b8eeee108008\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca0789789100\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f277cee9c16dc6bca02eba4d91566\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee484875b6a9ead2955b8069\",\r",
							"    EndToEndId: \"b51ec534ee484875b6a9ead2955b8069\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a8416141ad1e58355b8eeee108007f7accd\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca0789789100\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f277cee9c16dc6bca02eba4d91566\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee484875b6a9ead2955b8069\",\r",
							"    EndToEndId: \"b51ec534ee484875b6a9ead2955b8069\"\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/pseudonyms/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(transactionGraph)}\r",
							"                    INSERT transaction INTO transactionRelationship\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba67c5\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"8d3b3600efb74f4196ac0e5e60365957\",\n            \"OrgnlEndToEndId\": \"8d3b3600efb74f4196ac0e5e60365957\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 2",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"const transactions = [\"96ae98292ec04bf2b58740ba99864c38\"]",
							"const graphTransactions = [",
							"    \"d923682a97089a8416151a561e58355b8eeee108007f7accd\",",
							"    \"d923682a97089a84142151ad1e58355b8eeee108008\",",
							"    \"d923652a37089a8416151ad1e58355b8eeee108007\"",
							"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Aggregated and commissioned transaction mirroring detected, Result for Rule 025 is true\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(false);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"            \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});",
							"",
							"pm.test(\"Remove Seed Data from transactionGraph\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/pseudonyms/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(graphTransactions)}",
							"                        REMOVE { _key: transaction } IN transactionRelationship",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"96ae98292ec04bf2b58740ba99864c38\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"9281f743b68c4e7e80c04c85934cf398\",\r",
							"                \"EndToEndId\": \"9281f743b68c4e7e80c04c85934cf398\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 9000,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 9000,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"352afab0eed3e035ff73cec442c7d4a9f66f289cee9c16dc6bca02eba4d91566\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"24058ebbdd500fe2307cdd15186e0abcd9726de434ae492dbe9d1e12822914aa\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"const transactionGraph = [{\r",
							"    _key: \"d923652a37089a8416151ad1e58355b8eeee108007\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec442c7d4a9f66f289cee9c16dc6bca02eba4d91566\",\r",
							"    _to: \"accounts/24058ebbdd500fe2307cdd15186e0abcd9726de434ae492dbe9d1e12822914aa\",\r",
							"    Amt: 9000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"9281f743b68c4e7e80c04c85934cf398\",\r",
							"    EndToEndId: \"9281f743b68c4e7e80c04c85934cf398\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a84142151ad1e58355b8eeee108008\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73c9c422c7d4a9f66f289cee9c16dc6bca0789789100\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec442c7d4a9f66f289cee9c16dc6bca02eba4d91566\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee4846375b6a9ead2955b8069\",\r",
							"    EndToEndId: \"b51ec534ee4846375b6a9ead2955b8069\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a8416151a561e58355b8eeee108007f7accd\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73c9c422c7d4a9f66f289cee9c16dc6bca0789789100\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec442c7d4a9f66f289cee9c16dc6bca02eba4d91566\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee4846375b6a9ead2955b8069\",\r",
							"    EndToEndId: \"b51ec534ee4846375b6a9ead2955b8069\"\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/pseudonyms/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(transactionGraph)}\r",
							"                    INSERT transaction INTO transactionRelationship\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba6784\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"5ab4fc7355de4ef8a75b78b00a681ed2\",\n            \"OrgnlEndToEndId\": \"2c516801007642dfb892944dde1cf846\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 4",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"const transactions = [\"96ae98292ec04b82985d40ba99864c38\"]",
							"const graphTransactions = [",
							"    \"d923682a97089a8416144758355b8eee108007f7accd4adc9dc706777d7\",",
							"    \"d923682a97089a8418780051878e58355b8eeee108008\",",
							"    \"d923682a97077a800616188ad1e58355b8eeee108007f7accd\"",
							"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Aggregated exact transaction mirroring detected, Result for Rule 025 is true\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(true);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"            \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});",
							"",
							"pm.test(\"Remove Seed Data from transactionGraph\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/pseudonyms/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(graphTransactions)}",
							"                        REMOVE { _key: transaction } IN transactionRelationship",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"96ae98292ec04b2985d40ba99864c38\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"7cca11d346934bae868e18d417790f39\",\r",
							"                \"EndToEndId\": \"7cca11d346934bae868e18d417790f39\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 9900,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 9900,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"352afab0eed3e035ff73ccc422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"24058ebbdd500fe7707cdd55486e0abcd9726de434ae492dbe9d1e12822914aa\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"const transactionGraph = [{\r",
							"    _key: \"d923682a97089a8416144758355b8eee108007f7accd4adc9dc706777d7\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73ccc422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/24058ebbdd500fe7707cdd55486e0abcd9726de434ae492dbe9d1e12822914aa\",\r",
							"    Amt: 9900,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"7cca11d346934bae868e18d417790f39\",\r",
							"    EndToEndId: \"7cca11d346934bae868e18d417790f39\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a8418780051878e58355b8eeee108008\",\r",
							"    _from: \"accounts/24058ebbdd500ge5707cdd77186e0abcd9726de434ae492dbe9d1e12822914aa\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73ccc422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ecc477575d6a9e772955b8069\",\r",
							"    EndToEndId: \"b51ec534ecc477575d6a9e772955b8069\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97077a800616188ad1e58355b8eeee108007f7accd\",\r",
							"    _from: \"accounts/24058ebbdd500ge5707cdd77186e0abcd9726de434ae492dbe9d1e12822914aa\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73ccc422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ecc477575d6a9e772955b8069\",\r",
							"    EndToEndId: \"b51ec534ecc477575d6a9e772955b8069\"\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/pseudonyms/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(transactionGraph)}\r",
							"                    INSERT transaction INTO transactionRelationship\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba67c4\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"2c516801007642dfb892944dde1cf\",\n            \"OrgnlEndToEndId\": \"7cca11d346934bae868e18d417790f39\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 6",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"const transactions = [\"96ae98292ec04bf999b5d40ba99864c38\"]",
							"const graphTransactions = [",
							"    \"d923682a97089a8416151ad1878355b8eeee108007f7accd4adc9dc706777d7\",",
							"    \"d923682a97089a84995122d1e58355b8eeee108008\",",
							"    \"d923682a9708998416141ad22e58355b8eeee108007f7accd\"",
							"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"No aggregated transaction mirroring detected - amount too high, Result for Rule 025 is false\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(false);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"            \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});",
							"",
							"pm.test(\"Remove Seed Data from transactionGraph\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/pseudonyms/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(graphTransactions)}",
							"                        REMOVE { _key: transaction } IN transactionRelationship",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"96ae98292ec04bf999b5d40ba99864c38\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"0bb671db40d248f9b4c66fc1c1bd6db9\",\r",
							"                \"EndToEndId\": \"0bb671db40d248f9b4c66fc1c1bd6db9\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 10100,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 10100,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca02eba4d91577\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"24058ebbdd500fe2307cdd55186e0abcd9726de437ae492dbe9d1e12822914aa\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"const transactionGraph = [{\r",
							"    _key: \"d923682a97089a8416151ad1878355b8eeee108007f7accd4adc9dc706777d7\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de437ae492dbe9d1e12822914aa\",\r",
							"    Amt: 10100,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"0bb671db40d248f9b4c66fc1c1bd6db9\",\r",
							"    EndToEndId: \"0bb671db40d248f9b4c66fc1c1bd6db9\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a84995122d1e58355b8eeee108008\",\r",
							"    _from: \"accounts/352afab0eed3e035ff77cec422c7d4a9f66f289cee9c16dc6bca0789789100\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca02eba4d91577\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee484875b6a99ad2955b8069\",\r",
							"    EndToEndId: \"b51ec534ee484875b6a99ad2955b8069\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a9708998416141ad22e58355b8eeee108007f7accd\",\r",
							"    _from: \"accounts/352afab0eed3e035ff77cec422c7d4a9f66f289cee9c16dc6bca0789789100\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca02eba4d91577\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee484875b6a99ad2955b8069\",\r",
							"    EndToEndId: \"b51ec534ee484875b6a99ad2955b8069\"\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/pseudonyms/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(transactionGraph)}\r",
							"                    INSERT transaction INTO transactionRelationship\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba67c4\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"0bb671db40d248f9b4c66fc1c1bd6db9\",\n            \"OrgnlEndToEndId\": \"0bb671db40d248f9b4c66fc1c1bd6db9\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 7",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"const transactions = [\"96ae98292ec04bf999b5d40ba99864c38\"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Unsuccessful transaction , Result for Rule 025 is false\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(false);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"                \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"96ae98292ec04bf999b5d40ba99864c38\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"2c516801007642df8897944dde1cf845\",\r",
							"                \"EndToEndId\": \"2c516801007642df8897944dde1cf845\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 10100,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 10100,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca02eba4d91577\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"24058ebbdd500fe2307cdd55186e0abcd9726de437ae492dbe9d1e12822914aa\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba67c4\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"5ab4fc7355de4ef8a75b78b00a681ed2\",\n            \"OrgnlEndToEndId\": \"2c516801007642dfb892944dde1cf845\",\n            \"TxSts\": \"ACSC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 8",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Insufficient transaction history, Result for Rule 025 is false\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(false);",
							"});",
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba67c4\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"2c516801009642dfb892944dde1cf845\",\n            \"OrgnlEndToEndId\": \"2c516801009642dfb892944dde1cf845\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 9",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"const transactions = [\"96ae98292ec0777b2985d40ba99864c38\"]",
							"const graphTransactions = [",
							"    \"d923682a9708916144758355eee108007f7accd4adc9dc706777d7\",",
							"    \"d923682a97089a89980051878e58355b8eeee108008\",",
							"    \"d923682a97077a900616188ad1e58355b8eeee108007f7d\",",
							"    \"d923682a97089a84120051878e58355b8eeee108008\",",
							"    \"d923682a97077a800126188ad1e58355b8eeee108007f7accd\",",
							"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"No aggregated transaction mirroring detected - amount too high, Result for Rule 025 is false\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(true);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"            \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});",
							"",
							"pm.test(\"Remove Seed Data from transactionGraph\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/pseudonyms/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(graphTransactions)}",
							"                        REMOVE { _key: transaction } IN transactionRelationship",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"96ae98292ec0777b2985d40ba99864c38\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"3641b4071c414a908868689b4c0c8a80\",\r",
							"                \"EndToEndId\": \"3641b4071c414a908868689b4c0c8a80\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 9900,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 9900,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"352afab0eed3e035ff73ccc4c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"24058ebbdd500fe7707cdd55986e0abcd9726de434ae492dbe9d1e12822914aa\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"const transactionGraph = [{\r",
							"    _key: \"d923682a9708916144758355eee108007f7accd4adc9dc706777d7\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73ccc4c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/24058ebbdd500fe7707cdd55986e0abcd9726de434ae492dbe9d1e12822914aa\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"3641b4071c414a908868689b4c0c8a80\",\r",
							"    EndToEndId: \"3641b4071c414a908868689b4c0c8a80\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a89980051878e58355b8eeee108008\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73ccddc4c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73ccc4c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 3000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACSC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"449d9e72fadc4e13876d06fcd47bf038\",\r",
							"    EndToEndId: \"449d9e72fadc4e13876d06fcd47bf038\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97077a900616188ad1e58355b8eeee108007f7d\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73ccddc4c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73ccc4c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 3000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACSC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"449d9e72fadc4e13876d06fcd47bf038\",\r",
							"    EndToEndId: \"449d9e72fadc4e13876d06fcd47bf038\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a84120051878e58355b8eeee108008\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73ccc4c7d4a966f289c7879c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73ccc4c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 7000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"bf991c96944d43689552b2950526f1a8\",\r",
							"    EndToEndId: \"bf991c96944d43689552b2950526f1a8\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97077a800126188ad1e58355b8eeee108007f7accd\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73ccc4c7d4a966f289c7879c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73ccc4c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 7000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"bf991c96944d43689552b2950526f1a8\",\r",
							"    EndToEndId: \"bf991c96944d43689552b2950526f1a8\"\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/pseudonyms/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(transactionGraph)}\r",
							"                    INSERT transaction INTO transactionRelationship\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b44436511974695be7dfb5516ba67c4\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"3641b4071c414a908868689b4c0c8a80\",\n            \"OrgnlEndToEndId\": \"3641b4071c414a908868689b4c0c8a80\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 10",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"const transactions = [\"96ae98292ec04bf29b5d40ba99864c38\"]",
							"const graphTransactions = [",
							"    \"d923682a97089a8416151ad1e58355b8e777908007\",",
							"    \"d923682a97089a8416151878e58355b8eeee108008\",",
							"    \"d923682a97077a8416151ad1e58355b8eeee108007f7accd\"",
							"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Aggregated exact transaction mirroring detected, Result for Rule 025 is true\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(false);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"            \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});",
							"",
							"pm.test(\"Remove Seed Data from transactionGraph\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/pseudonyms/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(graphTransactions)}",
							"                        REMOVE { _key: transaction } IN transactionRelationship",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"96ae98292ec04bf29b5d40ba99864c38\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"b51ec534ee48-4575-b6a9-ead2955b8069\",\r",
							"                \"EndToEndId\": \"b51ec534ee48-4575-b6a9-ead2955b8069\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 9899 ,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 9899 ,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"e2fa05b6a56ceedb37581703b98590b44194a8c0d2799f4319ebbece5e20ecc1\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"efdafefdee55c7a1e5eba4ccc0f01639dc37a020241b20495378f5a1343985b4\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"const transactionGraph = [{\r",
							"    _key: \"d923682a97089a8416151ad1e58355b8e777908007\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca0777a4d91566\",\r",
							"    _to: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de434ae4927779d1e12822914aa\",\r",
							"    Amt: 9899,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"2c516801007642dfb892944dde1cf8\",\r",
							"    EndToEndId: \"2c516801007642dfb892944dde1cf8\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a8416151878e58355b8eeee108008\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f77f289cee9c16dc6bca0789789100\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca0777a4d91566\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee484575b6a9e772955b8069\",\r",
							"    EndToEndId: \"b51ec534ee484575b6a9e772955b8069\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97077a8416151ad1e58355b8eeee108007f7accd\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f77f289cee9c16dc6bca0789789100\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289cee9c16dc6bca0777a4d91566\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee484575b6a9e772955b8069\",\r",
							"    EndToEndId: \"b51ec534ee484575b6a9e772955b8069\"\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/pseudonyms/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(transactionGraph)}\r",
							"                    INSERT transaction INTO transactionRelationship\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba67c4\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"5ab4fc7355de4ef8a75b78b00a681ed2\",\n            \"OrgnlEndToEndId\": \"2c516801007642dfb892944dde1cf8\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 11",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"const transactions = [\"96ae98292ec04bf29b5d40ba99864c38\"]",
							"const graphTransactions = [",
							"    \"d923682a97089a8416151ad1e5835578eeee108007f7accd4adc9dc706777d7\",",
							"    \"d923682a97089a841898951878e99355b8eeee108008\",",
							"    \"d923682a97077a841615188a67e899355b8eeee108007f7accd\"",
							"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"No transaction mirroring detected - amount too high, Result for Rule 025 is false\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(false);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"            \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});",
							"",
							"pm.test(\"Remove Seed Data from transactionGraph\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/pseudonyms/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(graphTransactions)}",
							"                        REMOVE { _key: transaction } IN transactionRelationship",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"\r",
							"const ruleConfig = [\r",
							"   {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"8cc4f6ffb4fd4e31b42aec0ed5d600a78799\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"2c516801007642dfb8892944dde1cf\",\r",
							"                \"EndToEndId\": \"2c516801007642dfb8892944dde1cf\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 10300,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 10300,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"352afab0eed3e035ff73cec422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"24058ebbdd500fe2307cdd55186e0abcd9726de477ae492dbe9d1e12822914aa\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"const transactionGraph = [{\r",
							"    _key: \"d923682a97089a8416151ad1e5835578eeee108007f7accd4adc9dc706777d7\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de477ae492dbe9d1e12822914aa\",\r",
							"    Amt: 10300,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"2c516801007642dfb8892944dde1cf\",\r",
							"    EndToEndId: \"2c516801007642dfb8892944dde1cf\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a841898951878e99355b8eeee108008\",\r",
							"    _from: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de477ae492dbe9d1e12822914aa\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee477575b6a9e882955b8069\",\r",
							"    EndToEndId: \"b51ec534ee477575b6a9e882955b8069\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97077a841615188a67e899355b8eeee108007f7accd\",\r",
							"    _from: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de477ae492dbe9d1e12822914aa\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee477575b6a9e882955b8069\",\r",
							"    EndToEndId: \"b51ec534ee477575b6a9e882955b8069\"\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/pseudonyms/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(transactionGraph)}\r",
							"                    INSERT transaction INTO transactionRelationship\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba67c4\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"2c516801007642dfb8892944dde1cf\",\n            \"OrgnlEndToEndId\": \"2c516801007642dfb8892944dde1cf\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-1-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		},
		{
			"name": "AM-746 Scenario 12 E2E",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();",
							"const req = JSON.parse(request.data);",
							"const arangourl = pm.environment.get('arangourl');",
							"const transactions = [\"96ae98292ec04bf29b5d40ba99864c38\"]",
							"const graphTransactions = [",
							"    \"d923682a97089a8416151ad1e58355b8eeee108007f7accd4adc9dc7067767d7\"",
							"]",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"No transaction mirroring detected - amount too high, Result for Rule 025 is false\", function () {",
							"    pm.expect(jsonData.ruleResult.result).to.be.eql(false);",
							"});",
							"",
							"pm.test(\"Remove Seed Data from DB\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/transactionHistory/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(transactions)}",
							"                \"TxTp.FIToFICstmrCdt.GrpHdr\": {",
							"                \"MsgId",
							"                        REMOVE { _key: transaction } IN transactionHistory",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});",
							"",
							"pm.test(\"Remove Seed Data from transactionGraph\", function () {",
							"    pm.sendRequest({",
							"        url: '${arangourl}/_db/pseudonyms/_api/cursor',",
							"        method: 'POST',",
							"        header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },",
							"        body: {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                query: `FOR transaction IN ${JSON.stringify(graphTransactions)}",
							"                        REMOVE { _key: transaction } IN transactionRelationship",
							"                        OPTIONS { ignoreErrors: true }`",
							"            })",
							"        }",
							"    })",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"\r",
							"const now = new Date().getTime();\r",
							"const arangourl = pm.environment.get('arangourl');\r",
							"pm.globals.set(\"now\", new Date().toISOString());\r",
							"\r",
							"const ruleConfig = [\r",
							"    {\r",
							"   \"id\": \"025@1.0.0\",\r",
							"   \"cfg\": \"1.0.0\",\r",
							"   \"config\": {\r",
							"      \"timeframes\": [\r",
							"         {\r",
							"            \"threshold\": 86400000\r",
							"         }\r",
							"      ],\r",
							"      \"bands\": [\r",
							"         {\r",
							"            \"subRuleRef\": \".02\",\r",
							"            \"upperLimit\": 0.9,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too low\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".03\",\r",
							"            \"lowerLimit\": 0.9,\r",
							"            \"upperLimit\": 0.99,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated and commissioned transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".04\",\r",
							"            \"lowerLimit\": 0.99,\r",
							"            \"upperLimit\": 1.01,\r",
							"            \"outcome\": true,\r",
							"            \"reason\": \"Aggregated exact transaction mirroring detected\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".05\",\r",
							"            \"lowerLimit\": 1.01,\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"No aggregated transaction mirroring detected - amount too high\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".00\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Insufficient transaction history\"\r",
							"         },\r",
							"         {\r",
							"            \"subRuleRef\": \".01\",\r",
							"            \"outcome\": false,\r",
							"            \"reason\": \"Unsuccessful transaction\"\r",
							"         }\r",
							"      ]\r",
							"   }\r",
							"}\r",
							"]\r",
							"\r",
							"const pacs008Transactions = [{\r",
							"    \"TxTp\": \"pacs.008.001.10\",\r",
							"    \"FIToFICstmrCdt\": {\r",
							"        \"GrpHdr\": {\r",
							"            \"MsgId\": \"8cc4f6ffb4fd4e31b42aec0ed5d600a78799\",\r",
							"            \"CreDtTm\": new Date(now - 10000).toISOString(),\r",
							"            \"NbOfTxs\": 1,\r",
							"            \"SttlmInf\": {\r",
							"                \"SttlmMtd\": \"CLRG\"\r",
							"            }\r",
							"        },\r",
							"        \"CdtTrfTxInf\": {\r",
							"            \"PmtId\": {\r",
							"                \"InstrId\": \"2c516801007642dfb8892944dde1cf\",\r",
							"                \"EndToEndId\": \"2c516801007642dfb8892944dde1cf\"\r",
							"            },\r",
							"            \"IntrBkSttlmAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 10300,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"InstdAmt\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 10300,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                }\r",
							"            },\r",
							"            \"ChrgBr\": \"DEBT\",\r",
							"            \"ChrgsInf\": {\r",
							"                \"Amt\": {\r",
							"                    \"Amt\": 307.14,\r",
							"                    \"Ccy\": \"USD\"\r",
							"                },\r",
							"                \"Agt\": {\r",
							"                    \"FinInstnId\": {\r",
							"                        \"ClrSysMmbId\": {\r",
							"                            \"MmbId\": \"dfsp001\"\r",
							"                        }\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"InitgPty\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"Dbtr\": {\r",
							"                \"Nm\": \"April Blake Grant\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1968-02-01\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27730975224\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-730975224\"\r",
							"                }\r",
							"            },\r",
							"            \"DbtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"352afab0eed3e035ff73cec422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"April Grant\"\r",
							"            },\r",
							"            \"DbtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp001\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAgt\": {\r",
							"                \"FinInstnId\": {\r",
							"                    \"ClrSysMmbId\": {\r",
							"                        \"MmbId\": \"dfsp002\"\r",
							"                    }\r",
							"                }\r",
							"            },\r",
							"            \"Cdtr\": {\r",
							"                \"Nm\": \"Felicia Easton Quill\",\r",
							"                \"Id\": {\r",
							"                    \"PrvtId\": {\r",
							"                        \"DtAndPlcOfBirth\": {\r",
							"                            \"BirthDt\": \"1935-05-08\",\r",
							"                            \"CityOfBirth\": \"Unknown\",\r",
							"                            \"CtryOfBirth\": \"ZZ\"\r",
							"                        },\r",
							"                        \"Othr\": {\r",
							"                            \"Id\": \"+27707650428\",\r",
							"                            \"SchmeNm\": {\r",
							"                                \"Prtry\": \"MSISDN\"\r",
							"                            }\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"CtctDtls\": {\r",
							"                    \"MobNb\": \"+27-707650428\"\r",
							"                }\r",
							"            },\r",
							"            \"CdtrAcct\": {\r",
							"                \"Id\": {\r",
							"                    \"Othr\": {\r",
							"                        \"Id\": \"24058ebbdd500fe2307cdd55186e0abcd9726de477ae492dbe9d1e12822914aa\",\r",
							"                        \"SchmeNm\": {\r",
							"                            \"Prtry\": \"PSEUDO\"\r",
							"                        }\r",
							"                    }\r",
							"                },\r",
							"                \"Nm\": \"Felicia Quill\"\r",
							"            },\r",
							"            \"Purp\": {\r",
							"                \"Cd\": \"MP2P\"\r",
							"            }\r",
							"        },\r",
							"        \"RgltryRptg\": {\r",
							"            \"Dtls\": {\r",
							"                \"Tp\": \"BALANCE OF PAYMENTS\",\r",
							"                \"Cd\": \"100\"\r",
							"            }\r",
							"        },\r",
							"        \"RmtInf\": {\r",
							"            \"Ustrd\": \"Payment of USD 30713.75 from April to Felicia\"\r",
							"        },\r",
							"        \"SplmtryData\": {\r",
							"            \"Envlp\": {\r",
							"                \"Doc\": {\r",
							"                    \"Xprtn\": \"2021-11-30T10:38:56.000Z\"\r",
							"                }\r",
							"            }\r",
							"        }\r",
							"    }\r",
							"}]\r",
							"\r",
							"const transactionGraph = [{\r",
							"    _key: \"d923682a97089a8416151ad1e5835578eeee108007f7accd4adc9dc706777d7\",\r",
							"    _from: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    _to: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de477ae492dbe9d1e12822914aa\",\r",
							"    Amt: 10300,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"2c516801007642dfb8892944dde1cf\",\r",
							"    EndToEndId: \"2c516801007642dfb8892944dde1cf\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97089a841898951878e99355b8eeee108008\",\r",
							"    _from: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de477ae492dbe9d1e12822914aa\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.008.001.10\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee477575b6a9e882955b8069\",\r",
							"    EndToEndId: \"b51ec534ee477575b6a9e882955b8069\"\r",
							"},\r",
							"{\r",
							"    _key: \"d923682a97077a841615188a67e899355b8eeee108007f7accd\",\r",
							"    _from: \"accounts/24058ebbdd500fe2307cdd55186e0abcd9726de477ae492dbe9d1e12822914aa\",\r",
							"    _to: \"accounts/352afab0eed3e035ff73cec422c7d4a9f66f289c7879c16dc6bca02eba4d91577\",\r",
							"    Amt: 10000,\r",
							"    TxTp: \"pacs.002.001.12\",\r",
							"    TxSts: \"ACCC\",\r",
							"    CreDtTm: new Date(now).toISOString(),\r",
							"    PmtInfId: \"b51ec534ee477575b6a9e882955b8069\",\r",
							"    EndToEndId: \"b51ec534ee477575b6a9e882955b8069\"\r",
							"}]\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/transactionHistory/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(pacs008Transactions)}\r",
							"                    INSERT {_key: transaction.FIToFICstmrCdt.GrpHdr.MsgId, TxTp: transaction.TxTp, FIToFICstmrCdt: transaction.FIToFICstmrCdt} INTO transactionHistory\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/pseudonyms/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR transaction IN ${JSON.stringify(transactionGraph)}\r",
							"                    INSERT transaction INTO transactionRelationship\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});\r",
							"\r",
							"pm.sendRequest({\r",
							"    url: '${arangourl}/_db/Configuration/_api/cursor',\r",
							"    method: 'POST',\r",
							"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            query: `FOR config IN ${JSON.stringify(ruleConfig)}\r",
							"                    INSERT {_key: \"025\", id: config.id, cfg: config.cfg, config: config.config} INTO configuration\r",
							"                    OPTIONS { overwrite: true }`\r",
							"        })\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n   \"transaction\": {\n      \"TxTp\": \"pacs.002.001.12\",\n      \"FIToFIPmtSts\": {\n         \"GrpHdr\": {\n            \"MsgId\": \"6b444365119746c5be7dfb5516ba67c4\",\n            \"CreDtTm\": \"{{now}}\"\n         },\n         \"TxInfAndSts\": {\n            \"OrgnlInstrId\": \"2c516801007642dfb8892944dde1cf\",\n            \"OrgnlEndToEndId\": \"2c516801007642dfb8892944dde1cf\",\n            \"TxSts\": \"ACCC\",\n            \"ChrgsInf\": [\n               {\n                  \"Amt\": {\n                     \"Amt\": 307.14,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 153.57,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp001\"\n                        }\n                     }\n                  }\n               },\n               {\n                  \"Amt\": {\n                     \"Amt\": 30.71,\n                     \"Ccy\": \"USD\"\n                  },\n                  \"Agt\": {\n                     \"FinInstnId\": {\n                        \"ClrSysMmbId\": {\n                           \"MmbId\": \"dfsp002\"\n                        }\n                     }\n                  }\n               }\n            ],\n            \"AccptncDtTm\": \"2021-12-03T15:36:16.000Z\",\n            \"InstgAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp001\"\n                  }\n               }\n            },\n            \"InstdAgt\": {\n               \"FinInstnId\": {\n                  \"ClrSysMmbId\": {\n                     \"MmbId\": \"dfsp002\"\n                  }\n               }\n            }\n         }\n      }\n   },\n   \"networkMap\": {\n      \"_key\": \"26345403\",\n      \"_id\": \"networkConfiguration/26345403\",\n      \"_rev\": \"_cxc-1vO---\",\n      \"messages\": [\n      {\n         \"id\": \"999_025@1.0.0\",\n         \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-1-0\",\n         \"cfg\": \"1.0.0\",\n         \"txTp\": \"pacs.002.001.12\",\n         \"channels\": [\n            {\n               \"id\": \"001@1.0.0\",\n               \"host\": \"{{baseUrl}}function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\n               \"cfg\": \"1.0.0\",\n               \"typologies\": [\n                  {\n                     \"id\": \"999_025@1.0.0\",\n                     \"host\": \"{{baseUrl}}/function/off-typology-processor-rel-1-0-0\",\n                     \"cfg\": \"1.0.0\",\n                     \"rules\": [\n                        {\n                           \"id\": \"025@1.0.0\",\n                           \"host\": \"{{baseUrl}}/function/off-rule-025-rel-1-0-0\",\n                           \"cfg\": \"1.0.0\"\n                        }\n                     ]\n                  }\n               ]\n            }\n         ]\n      }\n     ]\n   }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/function/off-rule-025-rel-1-0-0/execute",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"function",
						"off-rule-025-rel-1-0-0",
						"execute"
					]
				}
			},
			"response": []
		}
	]
}